# Copyright (c) 2021, Arm Limited.
#
# SPDX-License-Identifier: MIT

header:
  version: 10
  includes:
    - meta-ewaol-config/kas/ewaol-release.yml

defaults:
  repos:
    refspec: master

repos:

  # Since in ewaol-release.yml we pin meta-arm repo, we exclude its layers in
  # here and eneable them in arm-machines.yml when included by specific kas
  # configs (e.g. n1sdp.yml)
  meta-arm:
    layers:
      meta-arm: excluded
      meta-arm-bsp: excluded
      meta-arm-toolchain: excluded

  meta-openembedded:
    url: https://git.openembedded.org/meta-openembedded
    path: layers/meta-openembedded
    layers:
      meta-oe:
      meta-filesystems:
      meta-networking:
      meta-python:
      meta-perl:

  meta-ewaol:
    layers:
      meta-ewaol-distro:

  meta-virtualization:
    url: https://git.yoctoproject.org/git/meta-virtualization
    path: layers/meta-virtualization

  poky:
    url: https://git.yoctoproject.org/git/poky
    path: layers/poky
    layers:
      meta:
      meta-poky:

local_conf_header:
  ewaol-base: |
    CONF_VERSION = "2"
    PACKAGECONFIG:remove:pn-qemu-system-native = "gtk+ sdl"

  diskmon: |
    BB_DISKMON_DIRS = "\
      STOPTASKS,${TMPDIR},1G,100K \
      STOPTASKS,${DL_DIR},1G,100K \
      STOPTASKS,${SSTATE_DIR},1G,100K \
      STOPTASKS,/tmp,100M,100K \
      ABORT,${TMPDIR},100M,1K \
      ABORT,${DL_DIR},100M,1K \
      ABORT,${SSTATE_DIR},100M,1K \
      ABORT,/tmp,10M,1K"

machine: unset
distro: ewaol

env:
    SSTATE_MIRRORS: ""
    SOURCE_MIRROR_URL: ""
    INHERIT: ""
    BB_GENERATE_MIRROR_TARBALLS: ""
    BB_NUMBER_THREADS: "${@os.cpu_count()}"

target:
  - ewaol-image-podman
  - ewaol-image-docker
